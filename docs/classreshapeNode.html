<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ModularML: reshapeNode&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ModularML
   </div>
   <div id="projectbrief">Machine learning framework in C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classreshapeNode-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">reshapeNode&lt; T &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A class representing a reshape node in a computational graph.  
 <a href="classreshapeNode.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="reshape__node_8hpp_source.html">reshape_node.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for reshapeNode&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classreshapeNode__inherit__graph.png" border="0" usemap="#areshapeNode_3_01T_01_4_inherit__map" alt="Inheritance graph"/></div>
<map name="areshapeNode_3_01T_01_4_inherit__map" id="areshapeNode_3_01T_01_4_inherit__map">
<area shape="rect" title="A class representing a reshape node in a computational graph." alt="" coords="5,79,152,104"/>
<area shape="rect" href="classNode.html" title="Abstract base class representing a node in a computational graph." alt="" coords="51,5,107,31"/>
<area shape="poly" title=" " alt="" coords="81,44,81,79,76,79,76,44"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for reshapeNode&lt; T &gt;:</div>
<div class="dyncontent">
<div class="center"><img src="classreshapeNode__coll__graph.png" border="0" usemap="#areshapeNode_3_01T_01_4_coll__map" alt="Collaboration graph"/></div>
<map name="areshapeNode_3_01T_01_4_coll__map" id="areshapeNode_3_01T_01_4_coll__map">
<area shape="rect" title="A class representing a reshape node in a computational graph." alt="" coords="5,79,152,104"/>
<area shape="rect" href="classNode.html" title="Abstract base class representing a node in a computational graph." alt="" coords="51,5,107,31"/>
<area shape="poly" title=" " alt="" coords="81,44,81,79,76,79,76,44"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a28062013fbea3ea5c6a52f9f8423e602" id="r_a28062013fbea3ea5c6a52f9f8423e602"><td class="memItemLeft" align="right" valign="top"><a id="a28062013fbea3ea5c6a52f9f8423e602" name="a28062013fbea3ea5c6a52f9f8423e602"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>AbstractTensor</b> = <a class="el" href="classTensor.html">Tensor</a>&lt; T &gt;</td></tr>
<tr class="separator:a28062013fbea3ea5c6a52f9f8423e602"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a120fdab219cd07364d16c73f12363570" id="r_a120fdab219cd07364d16c73f12363570"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreshapeNode.html#a120fdab219cd07364d16c73f12363570">reshapeNode</a> (shared_ptr&lt; const AbstractTensor &gt; data, shared_ptr&lt; const <a class="el" href="classTensor.html">Tensor</a>&lt; int64_t &gt; &gt; shape, shared_ptr&lt; AbstractTensor &gt; reshaped, int allowzero=0)</td></tr>
<tr class="memdesc:a120fdab219cd07364d16c73f12363570"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for <a class="el" href="classreshapeNode.html" title="A class representing a reshape node in a computational graph.">reshapeNode</a>.  <br /></td></tr>
<tr class="separator:a120fdab219cd07364d16c73f12363570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a9a7924983461bf13528ca911ce8947" id="r_a7a9a7924983461bf13528ca911ce8947"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreshapeNode.html#a7a9a7924983461bf13528ca911ce8947">forward</a> () override</td></tr>
<tr class="memdesc:a7a9a7924983461bf13528ca911ce8947"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the forward pass of the reshape operation.  <br /></td></tr>
<tr class="separator:a7a9a7924983461bf13528ca911ce8947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e131ab2c74f90cacdb96b318431c8d1" id="r_a6e131ab2c74f90cacdb96b318431c8d1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreshapeNode.html#a6e131ab2c74f90cacdb96b318431c8d1">areInputsFilled</a> () const override</td></tr>
<tr class="memdesc:a6e131ab2c74f90cacdb96b318431c8d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the input(s) are filled.  <br /></td></tr>
<tr class="separator:a6e131ab2c74f90cacdb96b318431c8d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac52c7420b66e643b35343a3ece42ba12" id="r_ac52c7420b66e643b35343a3ece42ba12"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreshapeNode.html#ac52c7420b66e643b35343a3ece42ba12">setInputs</a> (const <a class="el" href="classarray__mml.html">array_mml</a>&lt; GeneralDataTypes &gt; &amp;inputs) override</td></tr>
<tr class="memdesc:ac52c7420b66e643b35343a3ece42ba12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the input(s) for the node.  <br /></td></tr>
<tr class="separator:ac52c7420b66e643b35343a3ece42ba12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99fe876eb7cdb117f1996fcbb8c54a57" id="r_a99fe876eb7cdb117f1996fcbb8c54a57"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreshapeNode.html#a99fe876eb7cdb117f1996fcbb8c54a57">areOutputsFilled</a> () const override</td></tr>
<tr class="memdesc:a99fe876eb7cdb117f1996fcbb8c54a57"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the output(s) are filled.  <br /></td></tr>
<tr class="separator:a99fe876eb7cdb117f1996fcbb8c54a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c9b520f4a644fbe31b9c7a25005ae8" id="r_a69c9b520f4a644fbe31b9c7a25005ae8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classarray__mml.html">array_mml</a>&lt; GeneralDataTypes &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classreshapeNode.html#a69c9b520f4a644fbe31b9c7a25005ae8">getOutputs</a> () const override</td></tr>
<tr class="memdesc:a69c9b520f4a644fbe31b9c7a25005ae8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the output of the node.  <br /></td></tr>
<tr class="separator:a69c9b520f4a644fbe31b9c7a25005ae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classNode"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classNode')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classNode.html">Node</a></td></tr>
<tr class="memitem:abce703f211f6a577085b4b8ad68cbb19 inherit pub_methods_classNode" id="r_abce703f211f6a577085b4b8ad68cbb19"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNode.html#abce703f211f6a577085b4b8ad68cbb19">~Node</a> ()=default</td></tr>
<tr class="memdesc:abce703f211f6a577085b4b8ad68cbb19 inherit pub_methods_classNode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for the <a class="el" href="classNode.html" title="Abstract base class representing a node in a computational graph.">Node</a> class.  <br /></td></tr>
<tr class="separator:abce703f211f6a577085b4b8ad68cbb19 inherit pub_methods_classNode"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T&gt;<br />
class reshapeNode&lt; T &gt;</div><p>A class representing a reshape node in a computational graph. </p>
<p>This class inherits from the <a class="el" href="classNode.html" title="Abstract base class representing a node in a computational graph.">Node</a> class and represents the reshape node in a computational graph. It performs reshape after being given an input tensor and a shape tensor. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a120fdab219cd07364d16c73f12363570" name="a120fdab219cd07364d16c73f12363570"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a120fdab219cd07364d16c73f12363570">&#9670;&#160;</a></span>reshapeNode()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classreshapeNode.html">reshapeNode</a>&lt; T &gt;<a class="el" href="classreshapeNode.html">::reshapeNode</a> </td>
          <td>(</td>
          <td class="paramtype">shared_ptr&lt; const AbstractTensor &gt;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">shared_ptr&lt; const <a class="el" href="classTensor.html">Tensor</a>&lt; int64_t &gt; &gt;&#160;</td>
          <td class="paramname"><em>shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">shared_ptr&lt; AbstractTensor &gt;&#160;</td>
          <td class="paramname"><em>reshaped</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>allowzero</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for <a class="el" href="classreshapeNode.html" title="A class representing a reshape node in a computational graph.">reshapeNode</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Shared pointer to the tensor data. </td></tr>
    <tr><td class="paramname">shape</td><td>Shared pointer to the shape tensor (int64_t). </td></tr>
    <tr><td class="paramname">reshaped</td><td>Shared pointer to the reshaped tensor (output). </td></tr>
    <tr><td class="paramname">allowzero</td><td>=0 by default. allowzero=1 indicates that if any value in the ‘shape’ input is set to zero, the zero value is honored </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a6e131ab2c74f90cacdb96b318431c8d1" name="a6e131ab2c74f90cacdb96b318431c8d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e131ab2c74f90cacdb96b318431c8d1">&#9670;&#160;</a></span>areInputsFilled()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classreshapeNode.html">reshapeNode</a>&lt; T &gt;::areInputsFilled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the input(s) are filled. </p>

<p>Implements <a class="el" href="classNode.html#a7b7feb041f1dbd99219f058e61744374">Node</a>.</p>

</div>
</div>
<a id="a99fe876eb7cdb117f1996fcbb8c54a57" name="a99fe876eb7cdb117f1996fcbb8c54a57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99fe876eb7cdb117f1996fcbb8c54a57">&#9670;&#160;</a></span>areOutputsFilled()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classreshapeNode.html">reshapeNode</a>&lt; T &gt;::areOutputsFilled </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the output(s) are filled. </p>

<p>Implements <a class="el" href="classNode.html#a268f6ee57cb391b9ebe6b08a2d691429">Node</a>.</p>

</div>
</div>
<a id="a7a9a7924983461bf13528ca911ce8947" name="a7a9a7924983461bf13528ca911ce8947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a9a7924983461bf13528ca911ce8947">&#9670;&#160;</a></span>forward()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classreshapeNode.html">reshapeNode</a>&lt; T &gt;::forward </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the forward pass of the reshape operation. </p>
<p>This function reshapes the input tensor to the specified shape. It checks if the inputs are filled, casts the data and shape to the appropriate tensor types, and allocates the output tensor if necessary. It then extracts the shape values from the shape tensor, handles the special case where a dimension is set to -1 (inferred dimension), and computes the new shape. Finally, it copies the data from the input tensor to the reshaped output tensor and applies the reshape.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">std::runtime_error</td><td>if the inputs are not fully set, if the data or shape cannot be cast to the appropriate tensor types, if the output tensor is not allocated, if multiple -1 values are present in the shape tensor, or if the inferred dimension does not match the total elements. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classNode.html#a24e86cad9799a2157d1dd8b264537ef3">Node</a>.</p>

</div>
</div>
<a id="a69c9b520f4a644fbe31b9c7a25005ae8" name="a69c9b520f4a644fbe31b9c7a25005ae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c9b520f4a644fbe31b9c7a25005ae8">&#9670;&#160;</a></span>getOutputs()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classarray__mml.html">array_mml</a>&lt; GeneralDataTypes &gt; <a class="el" href="classreshapeNode.html">reshapeNode</a>&lt; T &gt;::getOutputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the output of the node. </p>
<dl class="section return"><dt>Returns</dt><dd>The output data. </dd></dl>

<p>Implements <a class="el" href="classNode.html#a3bdab94a8251368e536260e433bb2628">Node</a>.</p>

</div>
</div>
<a id="ac52c7420b66e643b35343a3ece42ba12" name="ac52c7420b66e643b35343a3ece42ba12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac52c7420b66e643b35343a3ece42ba12">&#9670;&#160;</a></span>setInputs()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classreshapeNode.html">reshapeNode</a>&lt; T &gt;::setInputs </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classarray__mml.html">array_mml</a>&lt; GeneralDataTypes &gt; &amp;&#160;</td>
          <td class="paramname"><em>inputs</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set the input(s) for the node. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inputs</td><td>The input data to be set, where inputs[0] is the data tensor and inputs[1] is the shape tensor. </td></tr>
  </table>
  </dd>
</dl>

<p>Implements <a class="el" href="classNode.html#a785a6ce30e86fcdfe40897c78e31842b">Node</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/runner/work/modularml/modularml/src/include/<a class="el" href="reshape__node_8hpp_source.html">reshape_node.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
