<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ModularML: ConvNode Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ModularML
   </div>
   <div id="projectbrief">Machine learning framework in C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="classConvNode-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">ConvNode Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p>A class representing a Convolutional node in a computational graph.  
 <a href="classConvNode.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="conv_8hpp_source.html">conv.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for ConvNode:</div>
<div class="dyncontent">
<div class="center"><img src="classConvNode__inherit__graph.png" border="0" usemap="#aConvNode_inherit__map" alt="Inheritance graph"/></div>
<map name="aConvNode_inherit__map" id="aConvNode_inherit__map">
<area shape="rect" title="A class representing a Convolutional node in a computational graph." alt="" coords="5,79,95,104"/>
<area shape="rect" href="classNode.html" title="Abstract base class representing a node in a computational graph." alt="" coords="22,5,78,31"/>
<area shape="poly" title=" " alt="" coords="53,44,53,79,47,79,47,44"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for ConvNode:</div>
<div class="dyncontent">
<div class="center"><img src="classConvNode__coll__graph.png" border="0" usemap="#aConvNode_coll__map" alt="Collaboration graph"/></div>
<map name="aConvNode_coll__map" id="aConvNode_coll__map">
<area shape="rect" title="A class representing a Convolutional node in a computational graph." alt="" coords="5,79,95,104"/>
<area shape="rect" href="classNode.html" title="Abstract base class representing a node in a computational graph." alt="" coords="22,5,78,31"/>
<area shape="poly" title=" " alt="" coords="53,44,53,79,47,79,47,44"/>
</map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a07dceca6a90b4174c2c420f00a669bea" id="r_a07dceca6a90b4174c2c420f00a669bea"><td class="memItemLeft" align="right" valign="top"><a id="a07dceca6a90b4174c2c420f00a669bea" name="a07dceca6a90b4174c2c420f00a669bea"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>T</b> = std::variant&lt; double, float &gt;</td></tr>
<tr class="separator:a07dceca6a90b4174c2c420f00a669bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ba16fe3a7b512b4594cfcf43b97c832" id="r_a3ba16fe3a7b512b4594cfcf43b97c832"><td class="memItemLeft" align="right" valign="top"><a id="a3ba16fe3a7b512b4594cfcf43b97c832" name="a3ba16fe3a7b512b4594cfcf43b97c832"></a>
using&#160;</td><td class="memItemRight" valign="bottom"><b>TensorT</b> = TensorVariant&lt; T &gt;</td></tr>
<tr class="separator:a3ba16fe3a7b512b4594cfcf43b97c832"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ac82719a3a08d244c04265ee4d863ced9" id="r_ac82719a3a08d244c04265ee4d863ced9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvNode.html#ac82719a3a08d244c04265ee4d863ced9">ConvNode</a> (std::string X, std::string W, std::string Y, <a class="el" href="classarray__mml.html">array_mml</a>&lt; uli &gt; dilations, <a class="el" href="classarray__mml.html">array_mml</a>&lt; uli &gt; padding, <a class="el" href="classarray__mml.html">array_mml</a>&lt; uli &gt; kernel_shape, <a class="el" href="classarray__mml.html">array_mml</a>&lt; uli &gt; stride, optional&lt; std::string &gt; B=std::nullopt, uli group=1)</td></tr>
<tr class="memdesc:ac82719a3a08d244c04265ee4d863ced9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for <a class="el" href="classConvNode.html" title="A class representing a Convolutional node in a computational graph.">ConvNode</a>.  <br /></td></tr>
<tr class="separator:ac82719a3a08d244c04265ee4d863ced9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad813402f031fddba42a8f5b01e5ee27f" id="r_ad813402f031fddba42a8f5b01e5ee27f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvNode.html#ad813402f031fddba42a8f5b01e5ee27f">ConvNode</a> (const json &amp;node)</td></tr>
<tr class="memdesc:ad813402f031fddba42a8f5b01e5ee27f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor for <a class="el" href="classConvNode.html" title="A class representing a Convolutional node in a computational graph.">ConvNode</a> from JSON.  <br /></td></tr>
<tr class="separator:ad813402f031fddba42a8f5b01e5ee27f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c5e91966bd89a064c3f3e8784345a03" id="r_a3c5e91966bd89a064c3f3e8784345a03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvNode.html#a3c5e91966bd89a064c3f3e8784345a03">forward</a> (std::unordered_map&lt; std::string, GeneralDataTypes &gt; &amp;iomap) override</td></tr>
<tr class="memdesc:a3c5e91966bd89a064c3f3e8784345a03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Performs the forward pass convolution operation.  <br /></td></tr>
<tr class="separator:a3c5e91966bd89a064c3f3e8784345a03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7359b13307360a9829329074ed0d19f9" id="r_a7359b13307360a9829329074ed0d19f9"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvNode.html#a7359b13307360a9829329074ed0d19f9">getInputs</a> () override</td></tr>
<tr class="memdesc:a7359b13307360a9829329074ed0d19f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get inputs.  <br /></td></tr>
<tr class="separator:a7359b13307360a9829329074ed0d19f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a358571537cc6539e9c661db13d9ca251" id="r_a358571537cc6539e9c661db13d9ca251"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConvNode.html#a358571537cc6539e9c661db13d9ca251">getOutputs</a> () override</td></tr>
<tr class="memdesc:a358571537cc6539e9c661db13d9ca251"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get outputs.  <br /></td></tr>
<tr class="separator:a358571537cc6539e9c661db13d9ca251"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classNode"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classNode')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classNode.html">Node</a></td></tr>
<tr class="memitem:abce703f211f6a577085b4b8ad68cbb19 inherit pub_methods_classNode" id="r_abce703f211f6a577085b4b8ad68cbb19"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNode.html#abce703f211f6a577085b4b8ad68cbb19">~Node</a> ()=default</td></tr>
<tr class="memdesc:abce703f211f6a577085b4b8ad68cbb19 inherit pub_methods_classNode"><td class="mdescLeft">&#160;</td><td class="mdescRight">Virtual destructor for the <a class="el" href="classNode.html" title="Abstract base class representing a node in a computational graph.">Node</a> class.  <br /></td></tr>
<tr class="separator:abce703f211f6a577085b4b8ad68cbb19 inherit pub_methods_classNode"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A class representing a Convolutional node in a computational graph. </p>
<p>This class inherits from the <a class="el" href="classNode.html" title="Abstract base class representing a node in a computational graph.">Node</a> class and represents a Conv node in a computational graph.</p>
<dl class="section author"><dt>Author</dt><dd>Tim Carlsson (<a href="#" onclick="location.href='mai'+'lto:'+'tim'+'ca'+'@ch'+'al'+'mer'+'s.'+'se'; return false;">timca<span class="obfuscator">.nosp@m.</span>@cha<span class="obfuscator">.nosp@m.</span>lmers<span class="obfuscator">.nosp@m.</span>.se</a>) </dd></dl>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ac82719a3a08d244c04265ee4d863ced9" name="ac82719a3a08d244c04265ee4d863ced9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac82719a3a08d244c04265ee4d863ced9">&#9670;&#160;</a></span>ConvNode() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ConvNode::ConvNode </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classarray__mml.html">array_mml</a>&lt; uli &gt;&#160;</td>
          <td class="paramname"><em>dilations</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classarray__mml.html">array_mml</a>&lt; uli &gt;&#160;</td>
          <td class="paramname"><em>padding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classarray__mml.html">array_mml</a>&lt; uli &gt;&#160;</td>
          <td class="paramname"><em>kernel_shape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classarray__mml.html">array_mml</a>&lt; uli &gt;&#160;</td>
          <td class="paramname"><em>stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">optional&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>B</em> = <code>std::nullopt</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uli&#160;</td>
          <td class="paramname"><em>group</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for <a class="el" href="classConvNode.html" title="A class representing a Convolutional node in a computational graph.">ConvNode</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">X</td><td>Shared pointer to the tensor X (data input). </td></tr>
    <tr><td class="paramname">W</td><td>Shared pointer to the tensor W (weights). </td></tr>
    <tr><td class="paramname">Y</td><td>Shared pointer to the output tensor Y. </td></tr>
    <tr><td class="paramname">dilations</td><td>Dilation value along each spatial axis of the filter. </td></tr>
    <tr><td class="paramname">padding</td><td>The shape of the convolution kernel. </td></tr>
    <tr><td class="paramname">kernel_shape</td><td>The shape of the convolution kernel. </td></tr>
    <tr><td class="paramname">stride</td><td>Stride along each spatial axis. </td></tr>
    <tr><td class="paramname">B</td><td>Optional shared pointer to the output tensor (bias). </td></tr>
    <tr><td class="paramname">group</td><td>number of groups input channels and out channels are divided into. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad813402f031fddba42a8f5b01e5ee27f" name="ad813402f031fddba42a8f5b01e5ee27f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad813402f031fddba42a8f5b01e5ee27f">&#9670;&#160;</a></span>ConvNode() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ConvNode::ConvNode </td>
          <td>(</td>
          <td class="paramtype">const json &amp;&#160;</td>
          <td class="paramname"><em>node</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor for <a class="el" href="classConvNode.html" title="A class representing a Convolutional node in a computational graph.">ConvNode</a> from JSON. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">node</td><td>JSON object representing the Conv node. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3c5e91966bd89a064c3f3e8784345a03" name="a3c5e91966bd89a064c3f3e8784345a03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c5e91966bd89a064c3f3e8784345a03">&#9670;&#160;</a></span>forward()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void ConvNode::forward </td>
          <td>(</td>
          <td class="paramtype">std::unordered_map&lt; std::string, GeneralDataTypes &gt; &amp;&#160;</td>
          <td class="paramname"><em>iomap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Performs the forward pass convolution operation. </p>
<p>The method computes the forward convolution by performing the following steps:</p>
<ol type="1">
<li><b>Validate Inputs</b>: The method first checks that all the inputs are valid. This includes verifying the dimensions of the input tensor, kernel size, stride, padding, and other convolution parameters to ensure compatibility.</li>
<li><b>Apply im2col Transformation</b>: The input tensor is transformed using the im2col operation. See explanation below. The transformed data is stored in a temporary tensor, ready for efficient matrix multiplication.</li>
<li><b>Perform GEMM (General Matrix Multiply)</b>: The core of the convolution operation is carried out using GEMM, which efficiently performs matrix multiplication. The im2col-transformed input tensor is multiplied with the kernel weights, which are reshaped appropriately. This operation produces the convolution results in the output tensor, which contains the feature maps after applying the kernel.</li>
<li><b>Add Bias (Optional)</b>: If a bias term is specified, it is added to the output of the GEMM operation. This bias is applied across the feature maps and is typically used to adjust the activation of the convolutional layer.</li>
<li><b>Store Result in Output <a class="el" href="classTensor.html" title="Abstract class representing a Tensor.">Tensor</a></b>: The final result of the convolution operation, after the optional bias addition, is stored in the output tensor <code>Y</code>, which represents the convolved feature maps. </li>
</ol>

<p>Implements <a class="el" href="classNode.html#a2bddc439cc3877b4caa7b7c6485f2cfe">Node</a>.</p>

</div>
</div>
<a id="a7359b13307360a9829329074ed0d19f9" name="a7359b13307360a9829329074ed0d19f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7359b13307360a9829329074ed0d19f9">&#9670;&#160;</a></span>getInputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; ConvNode::getInputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get inputs. </p>
<dl class="section return"><dt>Returns</dt><dd>The names of the inputs to the node. </dd></dl>

<p>Implements <a class="el" href="classNode.html#a8cb6c79059a25bc6ce17b3b269c18f46">Node</a>.</p>

</div>
</div>
<a id="a358571537cc6539e9c661db13d9ca251" name="a358571537cc6539e9c661db13d9ca251"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a358571537cc6539e9c661db13d9ca251">&#9670;&#160;</a></span>getOutputs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::string &gt; ConvNode::getOutputs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">override</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get outputs. </p>
<dl class="section return"><dt>Returns</dt><dd>The names of the outputs to the node. </dd></dl>

<p>Implements <a class="el" href="classNode.html#a45dcfb4f3bf9bd0199c8465464de75c6">Node</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/runner/work/modularml/modularml/src/include/nodes/<a class="el" href="conv_8hpp_source.html">conv.hpp</a></li>
<li>/home/runner/work/modularml/modularml/src/nodes/<b>conv.cpp</b></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
